# 第一章 介绍
这一章包含了使用flat assembler所最需要的全部信息。如果你是一个经验丰富的汇编语言程序员，在使用这个编译器之前你至少应该读一下这一章。   
## 1.1 编译器概述
flat assembler是一个速度很快的x86架构处理器下的汇编语言编译器，使用多次扫描来优化产生的机器代码的大小。它可以自编译，并且为不同的操作系统提供了不同的版本，这些版本都被设计通过系统命令行使用，互相没有任何差异。   
本文档也对专门为Windows系统设计的图形化界面IDE做了说明，该IDE有自己的整合编辑器而不是使用命令行。但从编译的角度来说，图形化IDE和命令行的版本功能上是一致的，这个文档接下来的部分（从1.2节开始）对其他的发行版来说也是相同的。图形化IDE版本的可行性文件是fasmw.exe，而命令行的版本是fasm.exe。
### 1.1.1 系统要求
所有版本的编译器都要求使用x86架构32位的处理器（至少80386），虽然也能生成适用x86架构16位处理器的代码。Windows命令行版本要求Win32操作系统，而Windows GUIb版本要求Win32 GUI系统版本4.0以上，所以它应该能够在兼容Windows 95的全部操作系统上运行。   
编译这个版本的示例代码要求把flat assembler包下的include文件夹路径设置到环境变量INCLUDE中。如果这个环境变量在你的系统中已经存在并有了被其他程序使用的路径，只要把include文件夹路径添加到已有路径后面就可以了(不同的路径需要用分号分割开)。如果你不想在系统中设置这样的环境变量，或者不知道怎么设置，你可以在flat assembler IDE的文件夹下编辑fasmw.ini文件（这个文件是fasmw.exe运行的时候创建的，但是你也可以自己创建）。这种情况下，你应该把Include变量值设置到Environment节中。比如，你把flat assembler解压到 C:\fasmw文件夹下，你应该把下面两行设置加到你 C:\fasmw\fasmw.ini文件中：   
>[Environment]   
>Include = C:\fasmw\include   

如果你没有把INCLUDE环境变量设置正确，那你只能在你想要编译的每个程序中手工包含Win32 includes的完整路径。   
### 1.1.2 编译的使用
使用flat assembler只需要双击fasmw.exe图标，或者把你的源文件拖拽到fasmw.exe图标内。你也可以后续使用File菜单中的Open命令打开新的源文件，或者直接把文件拖拽进编辑窗口。你可以同时打开多个源文件，每个文件都可以用编辑窗口底部的tab按钮进行切换。要选择一个文件进行编辑，只需要左键点击对应的tab。编译器默认全部的操作都是作用于你当前正在编辑的文件，但是你可以通过在指定文件右击选取Assign命令把该文件指定为默认处理文件。一次只能为编译器指定一个文件。   
当你的源文件准备好了，你可以使用Run菜单中的Compile命令编译文件。编译成功后，编译器会输出编译过程概要；否则它会输出发生错误的信息。编译概要包括编译器进行了多少次扫描，花了多少时间，生成的目标文件有多少字节。它还包含了一个命名为Display的文本文件（参见2.2.5），这个文件会包含在源文件中使用display指令输出任何信息。错误概要至少包含了错误信息和一个Display文本文件。如果错误和源文件中一些特定行有关，那概要会有一个文本说明，包含在预处理过程中产生的错误的预处理指令和展示全部和错误相关行的源文件列表，当你双击这个列表中的一行时，编辑器窗口会自动选定对应相关发生预处理错误的源代码行（如果包含这一行的文件没有在编辑器中打开，它会被自动打开）。   
Run命令会开始执行编译，如果编译出来的格式能够在Windows环境中执行，那编译成功后会自动执行程序，否则你会看到一条此类型的文件不能运行的信息。如果运行出错，编译器将使用和Compile命令一样的格式展示 错误。   
如果编译器耗光了内存，你可以使用Compiler setup对话框给编译器增加内存分配。你可以通过这个设置指定编译器可以使用多少KB的内存，甚至是编译器进程的优先等级。   
如果你想系统只能运行编译器的一个程序实例，只要在fasmw.ini文件的Options节添加`OneInstanceOnly=1`设置。   
### 1.1.3 编辑器键盘命令
这一节列举了编辑器中可以使用的全部键盘命令。除了特别列出的键，flat assembler的其他键盘命令都和DOS IDE是一样的。   
移动：   
左箭头              往左移动一个字符   
右箭头              往右移动一个字符   
上箭头              往上移动一行   
下箭头              往下移动一行   
Ctrl+左箭头         往右移动一个词   
Ctrl+右箭头         往左移动一个词   
Home键              移动到当前行首   
End键               移动到当前行尾   
PageUp键            向上翻一页   
PageDown键          向下翻一页   
Ctrl+Home           移动到当前页首行   
Ctrl+End            移动到当前页最后一行   
Ctrl+PageUp         移动到当前文档的第一行
Ctrl+PageDown       移动到当前文档最后一行   
以上每个移动命令再加上同时按Shift键将会选定文本。   

编辑：   
Insert键            转换插入和覆写模式   
Alt+Insert          转换水平和垂直文本模式   
Delete              删除当前字符   
Backspace           删除上一个字符   
Ctrl+Backspace      删除上一个单词   
Alt+Backspace       撤销删除（同Ctrl+Z）   
Ctrl+Y              删除当前行   
F6                  复制当前行   

块操作：   
Ctrl+Insert         复制选定文本（同Ctrl+C）   
Shift+Insert        从剪贴板黏贴（同Ctrl+V）   
Ctrl+Delete         删除当前选定文本   
Shift+Delete        剪切选定文本到剪贴板（同Ctrl+X）  
Ctrl+A              选定全部文本   

搜索：   
F5                  跳转到指定位置（同Ctrl+G）   
F7                  查找（同Ctrl+F）   
Shift+F7            查找下一个（同F3）   
Ctrl+F7             替换（同Ctrl+H）   

编译：   
F9                  编译并运行   
Ctrl+F9             编译   
Shift+F9            编译当前文件   
Ctrl+F8             编译构建符号信息   

其他键：   
F2                  保存当前文件   
Shift+F2            另存为   
F4                  打开文件   
Ctrl+N              新建文件   
Ctrl+Tab            切换到下一文件   
Ctrl+Shift+Tab      切换到上一文件   
Alt+[1-9]           切换到对应文件   
Esc                 关闭当前文件   
Alt+X               关闭全部文件并退出   
Ctrl+F6             打开计算器   
Alt+左箭头          滚动条往左滚动   
Alt+右箭头          滚动条忘右滚动   
Alt+上箭头          滚动条往上滚动   
Alt+下箭头          滚动条往下滚动   
Alt+Delete          放弃撤销   

特殊键：   
F1                 在帮助文档中查找   
Alt+F1             选定帮助文档
### 1.1.4 编辑器设置
在设置菜单中，还有一个编辑器的设置列表，可以开启和关闭编辑器相关设置选项。这一节将会介绍这些设置。   
安全选择（Secure selection）-当开启这个设置，被选择的部分将不会被删除。任何文本修改的操作对被选择的部分都无效。当这个设置被关闭的时候，任何的输入都会将当前选择的部分覆盖，只要用Del键就可以将选择的部分删除（而secure selection开启的时候需要用Ctrl+Del才能删除）。   
中括号自动补全-当输入[号时，会自动在后面补全]号。   
自动缩进-当键入Enter键新起一行时，光标会自动对齐到上一行非空字符列。当你在中间断行时，输入Enter键的光标后面如果有非空字符，它们会在新一行自动缩进，光标和非空字符之间的空格都会被忽略。   
智能制表符-当在当前行首输入Tab时，会将当前行自动对齐到上一行非空字符列。如果上一行没有任何字符，那么标准的制表符会占用8个字符的宽度。   
保存优化-如果这个设置开启，当保存文件的时候，全部空白区域的制表符或空格符都会被优化合并来获取最小的文件大小。如果这个选项关闭，那么空格区域都会按原样保存（但最后一行后面的空格不会被保存）。   
激活dead key（有关dead key的描述见https://en.wikipedia.org/wiki/Dead_key）-如果这个设置开启，会关闭编辑器中的dead key（一种不会立即产生字符的键，但是会根据接下来的按键决定应该产生怎样的字符-通常你通过在dead key后键入空格键来输入一个dead key的字符）。通常你如果的确需要经常键入一个dead key的字符，而不是要根据dead key的下一个字符来产生完整字符时会很有用。(译者注：中文好像没什么卵用，如法文那些，要通过两个按键决定一个字符的时候可能会有用)。

### 1.1.5 命令行执行编译器
从命令行执行编译，需要提供两个参数运行fasm.exe可执行文件，第一个是源文件名，第二个是生成文件名。如果没有第二个参数，输出文件的文件名会自动生成。在显示了程序名和版本信息后，编译器会从源文件读取数据并开始编译。当编译成功后，编译器会把生成的代码写入目标文件，并展示编译过程的概述；否则会展示发生错误的信息。   
源文件必须是一个文本文件，可以用任何的文本编译器生成。分行符允许DOS和Unix的标准，制表符被当做是空格。   
在命令行，你也可以加上-m命令紧跟着一个数字来指定flat assembler最大要使用的KB内存。在DOS版本这个参数的大小限制是可扩展内存的可用大小。-p参数紧跟着一个数字来限定编译器执行的扫描数。如果源代码不能在制定的扫描数之内生成，编译器会产生一个错误信息并结束，参数能设置最大的值是65536，当在命令行不使用这个参数就使用默认值100。也可以用-p参数紧跟着一个自定的数值来现在编译器能够执行的扫描遍数。   
命令行中的参数选项不能够影响编译的输出。flat assembler要求在源代码中去包含它需要的编译信息。比如要指定输出的格式你需要在源代码开始处使用format伪指令。